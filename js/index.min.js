!function(){"use strict";var submit=function(){var t;return $("form").submit(function(){t&&t()}),function(i){t=i}}(),cancel=function(){var t,i,e;return $("body").on("touchstart",function(t){i=t.originalEvent.changedTouches[0].pageX,e=t.originalEvent.changedTouches[0].pageY}),$("body").on("touchend",function(n){var a=n.originalEvent.changedTouches[0].pageX,s=n.originalEvent.changedTouches[0].pageY,o=a-i,r=s-e;Math.abs(o)>Math.abs(r)&&o>50&&t&&t()}),function(i){t=i}}(),_fly=function(t){if(t){var i=$(".card-fly").css("transition-property","none").css("visibility","").css("left","-50%"),e=$(".card-static").css("transition-property","").css("visibility","").css("left","100%");setTimeout(function(){i.css("transition-property","").css("left","50%")},50),setTimeout(function(){e.css("transition-property","none").css("left","150%").addClass("card-fly").removeClass("card-static"),i.css("transition-property","none").css("left","").removeClass("card-fly").addClass("card-static")},500)}else{var e=$(".card-static").css("transition-property","").css("visibility","").css("left","-100%"),i=$(".card-fly").css("transition-property","").css("visibility","").css("left","50%");setTimeout(function(){e.css("transition-property","none").css("left","150%").addClass("card-fly").removeClass("card-static"),i.css("transition-property","none").css("left","").removeClass("card-fly").addClass("card-static")},500)}},FormInfo={preinit:function(){setTimeout(function(){$(".main-frame").css("opacity","0.95"),setTimeout(function(){$(".word").removeClass("word"),$(".progress").css("width","33.3%")},200)},1e3),FormInfo.init()},init:function(t){FormInfo.step=t||1,FormInfo.load(t?null:$(".card-static")),submit(function(){var t=$(".card-static");$(".card-fly");switch(FormInfo.step){case 1:if(!/^1[0-9]{10}$/.test(t.find("form [name=tel]").val()))return void t.find("form [name=tel]").parent(".form-info").addClass("wrong").find(".info-tip").html("检查一下你的手机号哦");Submit.save(),FormInfo.step=2,FormInfo.load(),_fly(),$(".card-fly .progress").css("width","66.6%");break;case 2:Submit.save(),Like.init()}}),cancel(function(){2==FormInfo.step&&(FormInfo.step=1,$(".card-fly .progress").css("width","33.3%"),FormInfo.load(),_fly(!0))})},load:function(t){switch(t=t||$(".card-fly"),FormInfo.step){case 1:t.find(".main-body h3").html("报名信息"),t.find(".main-info").html("届时将凭以下信息查询配对结果哦"),t.find(".form-submit button").html("下一步"),FormInfo.render([{name:"name",title:"姓名",value:Submit.name},{name:"tel",title:"手机",value:Submit.tel}],t);break;case 2:t.find(".main-body h3").html("其他信息"),t.find(".main-info").html("以下信息将被告知你的配对者哦"),t.find(".form-submit button").html("下一步"),FormInfo.render([{name:"gender",title:"性别",select:["","男","女"],value:Submit.gender},{name:"school",title:"学校",select:["","华南理工大学南校","华南理工大学北校","中山大学","华南师范大学","广东工业大学","广东外语外贸大学","广州中医药大学","广东药学院","广州大学","广州美术学院","星海音乐学院"],value:Submit.school},{name:"college",title:"学院",value:Submit.college},{name:"grade",title:"年级",select:["","大一","大二","大三","大四"],value:Submit.grade},{name:"wechat",title:"微信 选填",required:!1,value:Submit.wechat}]),t.find("form [name=wechat]").parent(".form-info").find(".info-tip").css("left","89px")}},render:function(t,i){var e=(i=i||$(".card-fly")).find(".form-body").html("");t.forEach(function(t){if(t.select){var i='<select class="info-input" name="'+t.name+'">';t.select.forEach(function(t){i+='<option value="'+t+'">'+t+"</option>"}),i+="</select>"}$('<div class="form-info"><span class="info-title">'+t.title+"</span>"+(t.select?i:'<input class="info-input" name="'+t.name+'">')+'<span class="info-tip"></span></div>').appendTo(e).find(".info-input").attr("required",!1!==t.required||null).on("input",function(){$(this.parentNode).removeClass("wrong").find(".info-tip").html("")}).val(t.value)}),e.find(".info-title").on("click",function(){$(this.parentNode).find(".info-input").focus()})}},Like={init:function(){$(".card-fly .progress").css("width","100%");var t=$(".card-fly");t.find(".main-body h3").html("爱好类型"),t.find(".main-info").css("display","").html("你将与拥有共同爱好的人配对哦"),$(".card-fly .form-submit").css("display","").find("button").html("提交"),t.find(".form-body").html($("#t-form-like").html()).find("a").click(function(){Game.init()}),_fly(),submit(function(){$(".card-fly .progress").css("width","100%"),Submit.save(),Submit.submit()}),cancel(function(){FormInfo.init(2),_fly(!0)})}},Game={init:function(){Game.r=[],Game.id=0,Game.load(),_fly(),submit(),cancel(function(){Game.id?(Game.id--,Game.load(),_fly(!0)):(Like.init(),_fly(!0))})},load:function(){var t=$(".card-fly");$(".card-fly .progress").css("width",12.5*Game.id+"%"),t.find(".main-info").css("display","none"),$(".card-fly .form-submit").css("display","none"),Game.render()},render:function(){var t=$(".card-fly");t.find(".main-body h3").html("测试<small>"+(Game.id+1)+"/8</small>");var i=Game.data[Game.id],e='<div class="game-options">',n=0;i.options.forEach(function(t){e+='<div data-type="'+t.type+'"><span class="quesmark">'+"ABCDEFG"[n]+"</span>"+(-1==t.text.indexOf("img")?'<span class="questext">'+t.text+"</span>":t.text)+"</div><br>",n++}),e+="</div>";var a=!1;t.find(".form-body").html('<div class="form-game"><div class="game-title">'+i.title+"</div>"+e+"</div>").find(".game-options>div").each(function(){$(this).click(function(){a||(a=!0,Game.r[Game.id]=this.dataset.type,function(t){$(t.parentNode).find(">div").each(function(){this!=t&&$(this).css("opacity","0")})}(this),setTimeout(function(){Game.id<7?(Game.id++,$(".card-fly .form-submit").css("display","none"),Game.load(),_fly()):($(".card-fly .progress").css("width","100%"),Game.Result.init()),a=!1},500))})})},data:[{title:"你最希望拥有的一件电影里的东西是什么",options:[{text:"多啦a梦的口袋",type:"动画"},{text:"憨豆先生的甲壳虫汽车",type:"喜剧爱情"},{text:"钢铁侠的铠甲",type:"科幻动作"},{text:"侦探福尔摩斯的烟斗",type:"惊悚悬疑"}]},{title:"你在周末会选择那种娱乐方式？",options:[{text:"坐过山车",type:"动画"},{text:"海边漫步",type:"喜剧爱情"},{text:"桌游",type:"科幻动作"},{text:"密室逃脱",type:"惊悚悬疑"}]},{title:"你最想成为以下哪部电影的主角",options:[{text:"金刚狼",type:"科幻动作"},{text:"神偷奶爸",type:"动画"},{text:"爱乐之城",type:"喜剧爱情"},{text:"嫌疑人X的献身",type:"惊悚悬疑"}]},{title:"一部影片中的男主和女主走到了一起，你觉得怎样的经历更加浪漫",options:[{text:"男主穿越时光爱上女主",type:"科幻动作"},{text:"男主帮助女主逃离了地狱",type:"惊悚悬疑"},{text:"两人青梅竹马，分分合合终于走到一起",type:"喜剧爱情"},{text:"像童话故事中王子和公主相遇那么美好",type:"动画"}]},{title:"如果有一个机会穿越到以下场景，你最想去哪一个？",options:[{text:'<div class="quesimg" style="background-image: url(./img/quesimg/2.jpg);"></div>',type:"动画"},{text:'<div class="quesimg" style="background-image: url(./img/quesimg/1.jpg);"></div>',type:"科幻动作"},{text:'<div class="quesimg" style="background-image: url(./img/quesimg/4.jpg);"></div>',type:"喜剧爱情"},{text:'<div class="quesimg" style="background-image: url(./img/quesimg/3.jpg);"></div>',type:"惊悚悬疑"}]},{title:"你希望收到以下哪个生日礼物？",options:[{text:"名侦探柯南卡通手办",type:"动画"},{text:"速度与激情同款汽车模型",type:"科幻动作"},{text:"美女与野兽手机壳",type:"喜剧爱情"},{text:"东野圭吾的小说",type:"惊悚悬疑"}]},{title:"你希望娃娃机里放的是什么玩偶？",options:[{text:"蜘蛛侠",type:"科幻动作"},{text:"小黄人",type:"动画"},{text:"小怪物",type:"惊悚悬疑"},{text:"布朗熊",type:"喜剧爱情"}]},{title:"如果你有一个空闲的下午，你会选择在华工的哪个地方消遣时间？",options:[{text:"图书馆",type:"惊悚悬疑"},{text:"宿舍 ",type:"动画"},{text:"咖啡厅 ",type:"喜剧爱情"},{text:"体育场",type:"科幻动作"}]}],Result:{init:function(){var t=$(".card-fly");t.find(".main-info").css("display","").html("不满意结果可以点击重新选择哦"),$(".card-fly .form-submit").css("display","").find("button").html("提交"),t.find(".form-submit").css("display",""),t.find(".main-body h3").html("测试结果");var i=0,e=[];Game.r.forEach(function(t){Game[t]?Game[t]++:Game[t]=1}),["喜剧爱情","惊悚悬疑","科幻动作","动画","剧情"].forEach(function(t){Game[t]&&(Game[t]==i?e.push(t):Game[t]>i&&(i=Game[t],e=[t]))}),e=e[Math.floor(Math.random()*e.length)],t.find(".form-body").html($("#t-form-result").html()).find("[name=like]").val(e),_fly(),submit(function(){Submit.save(),Submit.submit()}),cancel()}}},Submit={save:function(){$(".card-static form [name]").each(function(){Submit[this.name]=this.value})},submit:function(){Submit.loading||(Submit.loading=!0,Submit.button=$(".card-static button").html(),$(".card-static button").html("提交中..."),$.post("./api/upload.php",{name:Submit.name,gender:Submit.gender,school:Submit.school,college:Submit.college,grade:{"大一":1,"大二":2,"大三":3,"大四":4}[Submit.grade],tel:Submit.tel,wechat:Submit.wechat,like:Submit.like}).done(function(t){if(t.err)return Submit.loading=!1,$(".card-static button").html(Submit.button),alert(t.msg);submit(),End.init()}).fail(function(){Submit.loading=!1,$(".card-static button").html(Submit.button),alert("网络异常")}))}},End={init:function(){var frame=$(".card-fly");frame.find(".main-info").css("display","none"),frame.find(".progress-frame").css("display","none"),frame.find(".form-submit button").html("领取印花"),frame.find(".main-body h3").html("提交成功"),frame.find(".form-body").html($("#t-form-end").html()),_fly(),submit(function(){location.href=eval(function(t,i,e,n,a,s){if(a=function(t){return(t<10?"":a(parseInt(t/10)))+((t%=10)>35?String.fromCharCode(t+29):t.toString(36))},!"".replace(/^/,String)){for(;e--;)s[a(e)]=n[e]||a(e);n=[function(t){return s[t]}],a=function(){return"\\w+"},e=1}for(;e--;)n[e]&&(t=t.replace(new RegExp("\\b"+a(e)+"\\b","g"),n[e]));return t}('"3://4.2.0/1/8/9/7?5=6"',0,10,"cn|wechat_bbt|withcic|https|100steps|get|duiduipeng|addPrize|Home|Vote".split("|"),0,{}))}),cancel()}};$(window).on("load",function(){FormInfo.preinit(),setTimeout(function(){},2e3)}),navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)&&$("button").addClass("button-ios")}();